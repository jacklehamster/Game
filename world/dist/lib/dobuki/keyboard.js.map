{"version":3,"sources":["../../../lib/dobuki/keyboard.js"],"names":["global","factory","exports","module","define","amd","DOK","core","keyboard","requireScripts","logScript","destroyEverything","clearListeners","document","removeEventListener","handleKey","addListeners","addEventListener","e","target","body","type","keyCode","time","preventDefault","keyDown","key","anyKeyPressed","keys","i","arguments","length","mov","getMove","dx","dy","combineMethods"],"mappings":";;;;AAAC,WAAUA,MAAV,EAAkBC,OAAlB,EAA2B;AAC1B,YAAOC,OAAP,yCAAOA,OAAP,OAAmB,QAAnB,IAA+B,OAAOC,MAAP,KAAkB,WAAjD,GAA+DF,QAAQC,OAAR,CAA/D,GACA,OAAOE,MAAP,KAAkB,UAAlB,IAAgCA,OAAOC,GAAvC,GAA6CD,OAAO,CAAC,SAAD,CAAP,EAAoBH,OAApB,CAA7C,GACCA,QAASD,OAAOM,GAAP,GAAaN,OAAOM,GAAP,IAAc,EAApC,CAFD;AAGA,CAJD,aAIS,UAAUC,IAAV,EAAgB;AAAE;;AAExB,QAAIC,WAAW,EAAf;AACA;;;AAGAD,SAAKE,cAAL,CAAoB,CAChB,UADgB,CAApB;AAGAF,SAAKG,SAAL;;AAEA;;;AAGA,aAASC,iBAAT,GAA6B;AACzBC;AACAJ,mBAAW,EAAX;AACH;;AAED,aAASI,cAAT,GAA0B;AACtBC,iBAASC,mBAAT,CAA6B,SAA7B,EAAwCC,SAAxC;AACAF,iBAASC,mBAAT,CAA6B,OAA7B,EAAsCC,SAAtC;AACH;;AAED,aAASC,YAAT,GAAwB;AACpBH,iBAASI,gBAAT,CAA0B,SAA1B,EAAqCF,SAArC;AACAF,iBAASI,gBAAT,CAA0B,OAA1B,EAAmCF,SAAnC;AACH;;AAED,aAASA,SAAT,CAAmBG,CAAnB,EAAsB;AAClB,YAAGA,EAAEC,MAAF,KAAWN,SAASO,IAAvB,EAA6B;AACzB,gBAAGF,EAAEG,IAAF,KAAW,SAAd,EAAyB;AACrB,oBAAG,CAACb,SAASU,EAAEI,OAAX,CAAJ,EAAyB;AACrBd,6BAASU,EAAEI,OAAX,IAAsBf,KAAKgB,IAA3B;AACH;AACJ,aAJD,MAIO;AACH,uBAAOf,SAASU,EAAEI,OAAX,CAAP;AACH;AACDJ,cAAEM,cAAF;AACH;AACJ;;AAED,aAASC,OAAT,CAAiBC,GAAjB,EAAsB;AAClB,eAAOlB,SAASkB,GAAT,CAAP;AACH;;AAED,aAASC,aAAT,CAAuBC,IAAvB,EAA6B;AACzB,aAAI,IAAIC,IAAE,CAAV,EAAYA,IAAEC,UAAUC,MAAxB,EAA+BF,GAA/B,EAAoC;AAChC,gBAAGJ,QAAQK,UAAUD,CAAV,CAAR,CAAH,EAA0B;AACtB,uBAAO,IAAP;AACH;AACJ;AACD,eAAO,KAAP;AACH;;AAED,QAAIG,MAAM,CAAC,CAAD,EAAG,CAAH,CAAV;AACA,aAASC,OAAT,GAAmB;AACf,YAAIC,KAAK,CAAT;AAAA,YAAYC,KAAG,CAAf;AACA,YAAG7B,IAAIqB,aAAJ,CAAkB,EAAlB,EAAqB,EAArB,CAAH,EAA6B;AACzBQ;AACH;AACD,YAAG7B,IAAIqB,aAAJ,CAAkB,EAAlB,EAAqB,EAArB,CAAH,EAA6B;AACzBQ;AACH;AACD,YAAG7B,IAAIqB,aAAJ,CAAkB,EAAlB,EAAqB,EAArB,CAAH,EAA6B;AACzBO;AACH;AACD,YAAG5B,IAAIqB,aAAJ,CAAkB,EAAlB,EAAqB,EAArB,CAAH,EAA6B;AACzBO;AACH;AACDF,YAAI,CAAJ,IAASE,EAAT;AACAF,YAAI,CAAJ,IAASG,EAAT;AACA,eAAOH,GAAP;AACH;;AAED;;;AAGAzB,SAAKkB,OAAL,GAAeA,OAAf;AACAlB,SAAK0B,OAAL,GAAeA,OAAf;AACA1B,SAAKoB,aAAL,GAAqBA,aAArB;AACApB,SAAKI,iBAAL,GAAyBJ,KAAK6B,cAAL,CAAoBzB,iBAApB,EAAuCJ,KAAKI,iBAA5C,CAAzB;;AAEA;;;AAGAK;AACF,CA3FD,CAAD","file":"keyboard.js","sourcesContent":["(function (global, factory) {\n \ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n \ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n \t(factory((global.DOK = global.DOK || {})));\n }(this, (function (core) { 'use strict';\n    \n    var keyboard = {};\n    /**\n     *  HEADER\n     */   \n    core.requireScripts([\n        'setup.js',\n    ]);\n    core.logScript();\n\n    /**\n     *  FUNCTION DEFINITIONS\n     */   \n    function destroyEverything() {\n        clearListeners();\n        keyboard = {};\n    }\n    \n    function clearListeners() {\n        document.removeEventListener(\"keydown\", handleKey);\n        document.removeEventListener(\"keyup\", handleKey);\n    }\n    \n    function addListeners() {\n        document.addEventListener(\"keydown\", handleKey);\n        document.addEventListener(\"keyup\", handleKey);\n    }\n    \n    function handleKey(e) {\n        if(e.target===document.body) {\n            if(e.type === \"keydown\") {\n                if(!keyboard[e.keyCode]) {\n                    keyboard[e.keyCode] = core.time;\n                }\n            } else {\n                delete keyboard[e.keyCode];\n            }\n            e.preventDefault();\n        }\n    }\n    \n    function keyDown(key) {\n        return keyboard[key];\n    }\n    \n    function anyKeyPressed(keys) {\n        for(var i=0;i<arguments.length;i++) {\n            if(keyDown(arguments[i])) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    var mov = [0,0];\n    function getMove() {\n        var dx = 0, dy=0;\n        if(DOK.anyKeyPressed(87,38)) {\n            dy++;\n        }\n        if(DOK.anyKeyPressed(83,40)) {\n            dy--;\n        }\n        if(DOK.anyKeyPressed(65,37)) {\n            dx--;\n        }\n        if(DOK.anyKeyPressed(68,39)) {\n            dx++;\n        }\n        mov[0] = dx;\n        mov[1] = dy;\n        return mov;\n    }\n\n    /**\n     *  PUBLIC DECLARATIONS\n     */\n    core.keyDown = keyDown;\n    core.getMove = getMove;\n    core.anyKeyPressed = anyKeyPressed;\n    core.destroyEverything = core.combineMethods(destroyEverything, core.destroyEverything);\n\n    /**\n     *   PROCESSES\n     */\n    addListeners();\n })));"]}