{"version":3,"sources":["../../../lib/dobuki/audio.js"],"names":["global","factory","exports","module","define","amd","DOK","core","audios","requireScripts","logScript","stopAllMusic","i","hasOwnProperty","isPlaying","stopMusic","playMusic","mp3","count","audio","Audio","volume","play","addEventListener","currentTime","pause","destroyEverything","combineMethods"],"mappings":";;;;AAAC,WAAUA,MAAV,EAAkBC,OAAlB,EAA2B;AAC1B,YAAOC,OAAP,yCAAOA,OAAP,OAAmB,QAAnB,IAA+B,OAAOC,MAAP,KAAkB,WAAjD,GAA+DF,QAAQC,OAAR,CAA/D,GACA,OAAOE,MAAP,KAAkB,UAAlB,IAAgCA,OAAOC,GAAvC,GAA6CD,OAAO,CAAC,SAAD,CAAP,EAAoBH,OAApB,CAA7C,GACCA,QAASD,OAAOM,GAAP,GAAaN,OAAOM,GAAP,IAAc,EAApC,CAFD;AAGA,CAJD,aAIS,UAAUC,IAAV,EAAgB;AAAE;;AAExB,QAAIC,SAAS,EAAb;;AAEA;;;AAGAD,SAAKE,cAAL,CAAoB,CAChB,UADgB,CAApB;AAGAF,SAAKG,SAAL;;AAEA;;;AAGA,aAASC,YAAT,GAAwB;AACpB,aAAI,IAAIC,CAAR,IAAaJ,MAAb,EAAqB;AACjB,gBAAGA,OAAOK,cAAP,CAAsBD,CAAtB,KAA4BE,UAAUF,CAAV,CAA/B,EAA6C;AACzCG,0BAAUH,CAAV;AACH;AACJ;AACJ;;AAED,aAASI,SAAT,CAAmBC,GAAnB,EAAwBC,KAAxB,EAA+B;AAC3B,YAAIC,QAAQ,IAAIC,KAAJ,CAAUH,GAAV,CAAZ;AACAE,cAAME,MAAN,GAAe,CAAf;AACAF,cAAMG,IAAN;;AAEAH,cAAMI,gBAAN,CAAuB,OAAvB,EAAgC,YAAW;AACvC,gBAAGL,KAAH,EAAU;AACNA;AACA,oBAAG,CAACA,KAAJ,EAAW;AACPH,8BAAUE,GAAV;AACA;AACH;AACJ;AACD,iBAAKO,WAAL,GAAmB,CAAnB;AACA,iBAAKF,IAAL;AACH,SAVD,EAUG,KAVH;;AAYAd,eAAOS,GAAP,IAAcE,KAAd;AACH;;AAED,aAASL,SAAT,CAAmBG,GAAnB,EAAwB;AACpB,eAAOT,OAAOS,GAAP,CAAP;AACH;;AAED,aAASF,SAAT,CAAmBE,GAAnB,EAAwB;AACpB,YAAGH,UAAUG,GAAV,CAAH,EAAmB;AACfT,mBAAOS,GAAP,EAAYQ,KAAZ;AACA,mBAAOjB,OAAOS,GAAP,CAAP;AACH;AACJ;;AAED,aAASS,iBAAT,GAA6B;AACzBf;AACH;;AAED;;;AAGAJ,SAAKS,SAAL,GAAiBA,SAAjB;AACAT,SAAKI,YAAL,GAAoBA,YAApB;AACAJ,SAAKmB,iBAAL,GAAyBnB,KAAKoB,cAAL,CAAoBD,iBAApB,EAAuCnB,KAAKmB,iBAA5C,CAAzB;;AAEA;;;AAKF,CA1ED,CAAD","file":"audio.js","sourcesContent":["(function (global, factory) {\n \ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n \ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n \t(factory((global.DOK = global.DOK || {})));\n }(this, (function (core) { 'use strict';\n    \n    var audios = {};\n    \n    /**\n     *  HEADER\n     */   \n    core.requireScripts([\n        'setup.js',\n    ]);\n    core.logScript();\n\n    /**\n     *  FUNCTION DEFINITIONS\n     */   \n    function stopAllMusic() {\n        for(var i in audios) {\n            if(audios.hasOwnProperty(i) && isPlaying(i)) {\n                stopMusic(i);\n            }\n        }\n    }\n    \n    function playMusic(mp3, count) {\n        var audio = new Audio(mp3);\n        audio.volume = 1;\n        audio.play();\n\n        audio.addEventListener('ended', function() {\n            if(count) {\n                count--;\n                if(!count) {\n                    stopMusic(mp3);\n                    return;\n                }\n            }\n            this.currentTime = 0;\n            this.play();\n        }, false);\n        \n        audios[mp3] = audio;\n    }\n\n    function isPlaying(mp3) {\n        return audios[mp3];\n    }\n     \n    function stopMusic(mp3) {\n        if(isPlaying(mp3)) {\n            audios[mp3].pause();\n            delete audios[mp3];\n        }\n    }\n         \n    function destroyEverything() {\n        stopAllMusic();\n    }\n   \n    /**\n     *  PUBLIC DECLARATIONS\n     */\n    core.playMusic = playMusic;\n    core.stopAllMusic = stopAllMusic;\n    core.destroyEverything = core.combineMethods(destroyEverything, core.destroyEverything);\n\n    /**\n     *   PROCESSES\n     */\n    \n     \n })));"]}